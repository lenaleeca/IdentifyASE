<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dr. Na Li" />

<meta name="date" content="2025-02-21" />

<title>Identify Adult Sepsis Events</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Identify Adult Sepsis Events</h1>
<h4 class="author">Dr. Na Li</h4>
<h4 class="date">2025-02-21</h4>



<hr />
<div id="background" class="section level2">
<h2>Background</h2>
<p>Sepsis, a clinical syndrome of “life-threatening organ dysfunction
caused by a dysregulated host response to infection” is estimated to
affect 49 million people annually, causing 20% of all worldwide deaths.
Despite its critical public health importance, sepsis identification
remains a challenge.</p>
<p>The <strong>Adult Sepsis Event (ASE) Toolkit</strong> developed by
the <strong>U.S. Centers for Disease Control and Prevention
(CDC)</strong> , provides a standardized framework for sepsis
surveillance by leveraging electronic health record (EHR)-based
algorithms. This toolkit is designed to enhance the consistency of
sepsis identification and reporting, thereby enabling healthcare
institutions to monitor trends, assess interventions, and improve care
delivery. It identifies ASE based on the following criteria:</p>
<ul>
<li><p><strong>Presumed serious infection</strong>: Blood culture
collection and at least 4 consecutive days of qualifying antimicrobial
treatment.</p></li>
<li><p><strong>Acute organ dysfunction</strong>: Initiation of
vasopressors, mechanical ventilation, changes in biomarkers such as
serum creatinine, total bilirubin, serum lactate, platelet
counts.</p></li>
</ul>
<p>For more detailed information, refer to the <a href="https://www.cdc.gov/sepsis/pdfs/sepsis-surveillance-toolkit-mar-2018_508.pdf">CDC
Hospital Toolkit for Adult Sepsis Surveillance</a>.</p>
<hr />
</div>
<div id="identifyase-package" class="section level2">
<h2><code>identifyASE</code> Package</h2>
<p>The <code>identifyASE</code> package follows a hierarchical structure
modelled on the ASE toolkit’s criteria to identify ASE in hospitalized
patients. The <code>define_ase</code> function sits at the top of the
hierarchical structure of the package and is the main function users
will interact with. This function initiates the analysis by sequentially
executing key functions to check the ASE criteria. The first criterion,
presumed infection, is checked by identifying blood culture events
through <code>slice_bcx_data</code> and qualifying antimicrobial
medications through <code>qualifying_abx_duration</code>. The second
criterion, acute organ dysfunction, is evaluated using
<code>add_aod_daily</code>. These key functions are supported by helper
functions at a lower level, which handle specific data transformations
and calculations.</p>
<hr />
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>To install the <code>identifyASE</code> package from GitHub, you need
the <code>devtools</code> package. If the repository is private, make
sure you have a personal access token.</p>
<div id="step-by-step-installation" class="section level3">
<h3>Step-by-step installation</h3>
<ol style="list-style-type: decimal">
<li>Install and load <code>devtools</code></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>, <span class="at">repos =</span> <span class="st">&quot;https://cran.rstudio.com&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(devtools)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Install the package from GitHub</li>
</ol>
<p>If the repository is private:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Replace &#39;your_personal_access_token&#39; with your GitHub personal access token</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;lenaleeca/identifyASE&quot;</span>, <span class="at">auth_token =</span> <span class="st">&quot;your_personal_access_token&quot;</span>)</span></code></pre></div>
<p>If the repository is public:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;lenaleeca/identifyASE&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Load the package</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(identifyASE)</span></code></pre></div>
</div>
<div id="dependencies" class="section level3">
<h3>Dependencies</h3>
<p>This package depends on the following R packages:</p>
<ul>
<li><code>dplyr</code></li>
<li><code>purrr</code></li>
<li><code>future</code></li>
<li><code>furrr</code></li>
<li><code>devtools</code></li>
</ul>
<p>Make sure these packages are installed and loaded in your R
environment.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;purrr&quot;</span>, <span class="st">&quot;future&quot;</span>, <span class="st">&quot;furrr&quot;</span>, <span class="st">&quot;devtools&quot;</span>), </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                                 <span class="at">repos =</span> <span class="st">&quot;https://cran.rstudio.com&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">library</span>(devtools)</span></code></pre></div>
<hr />
</div>
</div>
<div id="input-data" class="section level2">
<h2>Input Data</h2>
<p>The input data for this package consists of a dataset containing
daily patient-level information during hospitalization. The dataset
should include variables such as unique patient and hospitalization
identifiers, daily clinical variables (blood culture collection, use of
vasopressor and invasive mechanical ventilation, antimicrobial
treatments), and laboratory measurements. The data should be sorted
within each patient chronologically by the admission date and hospital
calendar day. The following table detailed the required variables:</p>
<table>
<colgroup>
<col width="13%" />
<col width="42%" />
<col width="43%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Description</th>
<th>Variable Calculation and Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>unique_pt_id</code></td>
<td>A unique identifier for each patient.</td>
<td>Direct extraction and require de-identification.</td>
</tr>
<tr class="even">
<td><code>seqnum</code></td>
<td>Unique hospital visit identification code/number assigned to each
visit for each patient.</td>
<td>Direct extraction and require de-identification.</td>
</tr>
<tr class="odd">
<td><code>day</code></td>
<td>Sequential number indicating the hospital day number, starting from
1 for the admission date.</td>
<td>Direct extraction and require de-identification.</td>
</tr>
<tr class="even">
<td><code>death</code></td>
<td>Binary: 1 = died on that day.</td>
<td>Can be extracted from health records.</td>
</tr>
<tr class="odd">
<td><code>ALL_DAYS</code></td>
<td>Number of calendar days during the hospitalization.</td>
<td>Can be calculated from health records.</td>
</tr>
<tr class="even">
<td><code>bcx_daily</code></td>
<td>Binary: 1 = a blood culture was collected that day.</td>
<td>Can be extracted from lab test &amp; culture data. Any blood culture
collected in the Emergency Department (ED) is assigned to day 1.</td>
</tr>
<tr class="odd">
<td><code>vasop_daily</code></td>
<td>Binary: 1 = received a qualifying vasopressor on that day.</td>
<td>Can be found from medication data. Refer to the CDC Adult Sepsis
Event (ASE) Toolkit, page 15 for specific medication names.</td>
</tr>
<tr class="even">
<td><code>imv_daily</code></td>
<td>Binary: 1 = had invasive mechanical ventilation on that day.</td>
<td>Can be found using procedure codes or ICU data if available.</td>
</tr>
<tr class="odd">
<td><code>lact_daily_hi</code></td>
<td>Highest measured value of serum lactate on that calendar day
(mmol/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="even">
<td><code>tbili_daily_hi</code></td>
<td>Highest measured value of total bilirubin on that calendar day
(µmol/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="odd">
<td><code>tbili_daily_lo</code></td>
<td>Lowest measured value of total bilirubin on that calendar day
(µmol/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="even">
<td><code>tbili_basleine</code></td>
<td>Lowest value of total bilirubin measured during the entire hospital
stay (µmol/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="odd">
<td><code>creat_daily_hi</code></td>
<td>Highest measured value of serum creatinine level on that calendar
day (µmol/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="even">
<td><code>creat_daily_lo</code></td>
<td>Lowest measured value of serum creatinine on that calendar day
(µmol/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="odd">
<td><code>creat_baseline</code></td>
<td>Lowest value of serum creatinine measured during the entire hospital
stay (µmol/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="even">
<td><code>plt_daily_hi</code></td>
<td>Highest measured value of platelet count on that calendar day
(10^9/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="odd">
<td><code>plt_daily_lo</code></td>
<td>Lowest measured value of platelet count on that calendar day
(10^9/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="even">
<td><code>plt_baseline</code></td>
<td>Highest value of platelet count during the entire hospital stay
(10^9/L).</td>
<td>Can be extracted from lab test data.</td>
</tr>
<tr class="odd">
<td><code>esrd_icd</code></td>
<td>Binary: 1 = had end-stage renal disease based on ICD-10 codes.</td>
<td>Calculated based on ICD-10 codes (For example, in Canada we use
N18.5, N08.35 and Z99.2).</td>
</tr>
<tr class="even">
<td><code>new_abx_start</code></td>
<td>Binary: 1 = any qualifying antimicrobial was first given on that
calendar day.</td>
<td>Can be found from medication data and calculation/programming is
required. Refer to the CDC Adult Sepsis Event (ASE) Toolkit, page 14 for
specific antimicrobial names.</td>
</tr>
<tr class="odd">
<td><code>abx_daily</code></td>
<td>Binary: 1 = received any qualifying antimicrobial on that calendar
day.</td>
<td>Can be found from medication data and calculation/programming is
required. Refer to the CDC Adult Sepsis Event (ASE) Toolkit, page 14 for
specific antimicrobial names.</td>
</tr>
</tbody>
</table>
<div id="handling-large-integer-variables" class="section level3">
<h3>Handling Large Integer Variables</h3>
<p>In some datasets, variables like <code>seqnum</code> or
<code>unique_pt_id</code> may be stored as <strong>integer64</strong>
instead of standard integer or numeric types. This can occur in the
following situations:</p>
<ul>
<li><strong>Large Integers</strong>: When your data includes integer
values exceeding the 32-bit integer limit (<code>2^31 - 1</code>), such
as large IDs or timestamps.<br />
</li>
<li><strong>Memory Efficiency</strong>: When you need to efficiently
store and manipulate large vectors of integer data without converting
them to double precision, which can lose exact integer
representation.</li>
<li><strong>Interfacing with external data</strong>: When importing data
from sources or systems (like databases) that use 64-bit integers,
ensuring data integrity when importing/exporting values.</li>
</ul>
<p>In such cases, please install and load the <code>bit64</code> package
before running the define_ase function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;bit64&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">library</span>(bit64)</span></code></pre></div>
</div>
</div>
<div id="key-functions" class="section level2">
<h2>Key Functions</h2>
<div id="slice_bcx_data" class="section level3">
<h3><code>slice_bcx_data</code></h3>
<p>This function identifies all blood culture events for each patient
and creates rolling BCWPs around each event. The BCWPs are stored in a
list, with each BCWP spans two days before and six days after the blood
culture date or until discharge/death, capturing relevant data for
independent analysis. The six-day post-blood culture period is derived
from the original two-day BCWP interval (i.e., +2 days) plus four
additional days to track sequential antimicrobial usage if a new
antimicrobial starts on the final BCWP day.</p>
</div>
<div id="qualifying_abx_duration" class="section level3">
<h3><code>qualifying_abx_duration</code></h3>
<p>This function identifies whether an antimicrobial treatment qualifies
within the context of presumed infection in the ASE toolkit. It first
detects the initiation of a new antimicrobial treatment in a window
period surrounding a blood culture and calculates the run length of
consecutive antibiotic days. The function then evaluates whether the
antibiotic duration meets predefined qualifying criteria outlined in the
toolkit, which includes a minimum duration of four consecutive days in
the absence of death, transfer or discharge. It ensures that events such
as death or acute transfer during the window period were properly
evaluated within the BCWPs by allowing antimicrobial treatment to
qualify for the presumed infection criteria even with fewer than four
consecutive QADs, provided treatment continued up to the day of death or
transfer, or one day prior.</p>
</div>
<div id="add_aod_daily" class="section level3">
<h3><code>add_aod_daily</code></h3>
<p>This function processes each BCWP and identifies presence of acute
organ dysfunction, based on initiation of vasopressors, mechanical
ventilation, changes in biomarkers such as serum creatinine, total
bilirubin, serum lactate, platelet counts. It compares best lab values
to predefined thresholds. It computes two sets of best lab values as
outlined on page 9 of the toolkit: one for community-onset AOD using
baseline values from the entire hospitalization, and another for
hospital-onset AOD using baseline values specific to BCWP.</p>
</div>
<div id="define_ase" class="section level3">
<h3><code>define_ase</code></h3>
<p>This is the main function users will interact with in the package. By
invoking <code>define_ase</code>, users automatically trigger the
sub-functions listed above and helper functions to sequentially evaluate
the ASE toolkit criteria. This function contains parameters for lab
measurement thresholds of creatinine, bilirubin, lactate, and platelet
counts, as well as the minimum duration of qualifying antimicrobial
treatment days. These parameters are preset to align with the ASE
toolkit’s criteria but can be customized to align with specific research
needs. Additionally, the function includes parameters such as
<code>cohort_id</code> and <code>transferout_id</code>, which allow
users to select subgroups and indicate patients who were transferred out
to an acute hospital.</p>
</div>
<div id="parameters-of-define_ase" class="section level3">
<h3>Parameters of <code>define_ase</code></h3>
<table>
<colgroup>
<col width="24%" />
<col width="75%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>daily_data</code></td>
<td>A data frame containing daily patient data with columns
<code>unique_pt_id</code>, <code>seqnum</code>, <code>day</code>,
<code>death</code>, <code>ALL_DAYS</code>, and other clinical
variables.</td>
</tr>
<tr class="even">
<td><code>transferout_id</code></td>
<td>A vector of sequence numbers (<code>seqnum</code>) indicating
patients who were transferred out to an acute hospital (default is
NULL).</td>
</tr>
<tr class="odd">
<td><code>cohort_id</code></td>
<td>A list of two vectors: patient IDs (<code>unique_pt_id</code>) and
sequence numbers (<code>seqnum</code>) for sub-group selection.</td>
</tr>
<tr class="even">
<td><code>abx_days</code></td>
<td>Required number of consecutive antimicrobial days (default is 4 in
the absence of death, transfer, or discharge, per the ASE toolkit).</td>
</tr>
<tr class="odd">
<td><code>window</code></td>
<td>The number of calendar days on either side of blood culture
collection. Must be an integer between 1 and 4 (default is 2, per the
ASE toolkit)</td>
</tr>
<tr class="even">
<td><code>creat_hi_lo_ratio</code></td>
<td>The ratio of high to low creatinine levels to define renal
dysfunction (default is 2, per the ASE toolkit).</td>
</tr>
<tr class="odd">
<td><code>creat_hi_cutoff</code></td>
<td>The cutoff value for high creatinine levels (default is 44 µmol/L,
default is 44 µmol/L, per the Risk, Injury, Failure, Loss, and End-stage
(RIFLE) renal disease classification system guidelines).</td>
</tr>
<tr class="even">
<td><code>tbili_hi_cutoff</code></td>
<td>The cutoff value for high bilirubin levels (default is 34.2 µmol/L,
per the ASE toolkit).</td>
</tr>
<tr class="odd">
<td><code>tbili_hi_lo_ratio</code></td>
<td>The ratio of high to low bilirubin levels to define liver
dysfunction (default is 2, per the ASE toolkit).</td>
</tr>
<tr class="even">
<td><code>lact_hi_cutoff</code></td>
<td>The cutoff value for high lactate levels (default is 2 mmol/L, per
the ASE toolkit).</td>
</tr>
<tr class="odd">
<td><code>plt_lo_cutoff</code></td>
<td>The cutoff value for low platelet counts (default is 100 10^9/L, per
the ASE toolkit).</td>
</tr>
<tr class="even">
<td><code>plt_lo_hi_ratio</code></td>
<td>The ratio of low to high platelet counts to define hematologic
dysfunction (default is 0.5, per the ASE toolkit).</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Get the path to the example data file inside the package</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;example_input_data&quot;</span>, <span class="st">&quot;daily_data.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;identifyASE&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Read the data </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data_path)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># Use `transferout_id` to indicate `seqnum` of patients who were transferred </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># out to an acute hospital</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>transferout_id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12602</span>,<span class="dv">54928</span>,<span class="dv">27201</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co"># Use `cohort_id` to select a subgroup by including 2 vectors: </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># The first vector contains patient IDs (`unique_pt_id`)  </span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co"># The second vector contains sequence numbers (`seqnum`)</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>cohort_id <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">12602</span>, <span class="dv">18613</span>))</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co"># Identify Adult Sepsis Events</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">define_ase</span>(<span class="at">daily_data =</span> daily_data, </span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>                                         <span class="at">transferout_id =</span> transferout_id, </span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>                                         <span class="at">cohort_id =</span> cohort_id,</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>                                         <span class="at">window =</span> <span class="dv">2</span>,</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>                                         <span class="at">abx_days =</span> <span class="dv">4</span>,</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>                                         <span class="at">creat_hi_lo_ratio =</span> <span class="dv">2</span>,</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>                                         <span class="at">creat_hi_cutoff =</span> <span class="dv">44</span>,</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>                                         <span class="at">tbili_hi_cutoff =</span> <span class="fl">34.2</span>,</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>                                         <span class="at">tbili_hi_lo_ratio =</span> <span class="dv">2</span>,</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>                                         <span class="at">lact_hi_cutoff =</span> <span class="dv">2</span>,</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>                                         <span class="at">plt_lo_cutoff =</span> <span class="dv">100</span>,</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>                                         <span class="at">plt_lo_hi_ratio =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<p>The output returned by the main function <code>define_ase</code>
corresponds to the selected BCWP (1-day, 2-day, 3-day or 4-day). It
includes a list of unique hospitalization identifiers where the
identified ASE cases occurred. It also provides separate lists of unique
hospitalization identifiers categorized by sepsis onset type
(community-onset vs. hospital-onset). The output also includes the data
surrounding the blood culture events, with additional variables such as
indicators for qualifying antimicrobial treatments, the presence of
various types of acute organ dysfunctions, and indicators for sepsis
onset types, which can be used for subsequent reporting.</p>
<p>To view the full output:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<p>The structure of the output is a list with multiple nested levels,
with the top-level keys “IDs”, “Data_(x)days”.</p>
<ol style="list-style-type: decimal">
<li><em>“IDs”</em> stores patient sequence numbers categorized by these
sub-keys:</li>
</ol>
<ul>
<li>$community-onset: community-onset ASE cases</li>
<li>$hospital-onset: hospital-onset ASE cases</li>
<li>$all_ase: all ASE cases</li>
</ul>
<p>Example:</p>
<ul>
<li>$IDs$community-onset: Includes a list of sequence numbers for
community-onset ASE cases in the specified window.</li>
</ul>
<p>To export the IDs lists to csv files, use the following code:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ids_list <span class="ot">&lt;-</span> result[[<span class="st">&quot;IDs&quot;</span>]] </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="co"># Iterate over the single-layer list</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">names</span>(ids_list), <span class="cf">function</span>(id_name) {</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="co"># Extract the data (sequence numbers) for the current id_name</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    data <span class="ot">&lt;-</span> ids_list[[id_name]]</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    </span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="co"># Convert the data to a data frame</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    data_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">seqnum =</span> data)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    <span class="co"># Define the output file name</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    file_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;IDs_&quot;</span>, id_name, <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    </span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>    <span class="co"># Export to CSV</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>    <span class="fu">write.csv</span>(data_df, file_name, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>    </span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    <span class="co"># Print confirmation message</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Exported:&quot;</span>, file_name, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  })</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><em>“Data_(x)days”</em> includes data of ASE cases surrounding the
selected (x) window (1-day,2-day, 3-day or 4-day). For example, if
window = 2, the output will include the dataset “Data_2days”. If window
= 3, the output will include the dataset “Data_3days”. The following
variables are added to the dataset:</li>
</ol>
<ul>
<li><strong>Antimicrobial Qualification</strong>
<ul>
<li><code>abx_qualifying</code>: Indicates whether the antimicrobial
treatment qualifies based on the toolkit criteria.</li>
<li><code>abx_qualifying_ep</code>: Indicates whether this patient
episode contains any qualifying antimicrobial treatment.</li>
</ul></li>
<li><strong>Acute Organ Dysfunction (AOD)</strong>
<ul>
<li><code>aod_cv_daily</code>, <code>aod_imv_daily</code>,
<code>aod_lactate_daily</code>, <code>aod_liver_daily</code>,
<code>aod_renal_daily</code>, <code>aod_heme_daily</code>: binary daily
indicators for specific types of acute organ dysfunction. These AOD
variables are derived using criteria outlined in the ASE Toolkit (pages
5 and 22).</li>
<li><code>aod_any_daily_comm</code>, <code>aod_any_daily_hosp</code>:
binary daily indicators for community vs. hospital onset AOD.</li>
</ul></li>
<li><strong>Sepsis Onset Type</strong>
<ul>
<li><code>sepsis_com_v2</code>: Binary indicator for community-onset
ASE.</li>
<li><code>sepsis_hosp_v2</code>: Binary indicator for hospital-onset
ASE.</li>
</ul></li>
</ul>
<p>To export the data to csv file, use the following code:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Export Data_2days to a csv file</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">write.csv</span>(result<span class="sc">$</span>Data_2days, <span class="st">&quot;Data_2days.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<hr />
</div>
<div id="searching-data-by-sequence-number-with-search_by_seqnum" class="section level2">
<h2>Searching Data by Sequence Number with
<code>search_by_seqnum</code></h2>
<p>The function <code>search_by_seqnum</code> is designed to assist
subsequent analysis. It allows users to search through a list of sliced
BCWP data and retrieve the data slices that match a specified sequence
number.</p>
<div id="example-1" class="section level3">
<h3>Example</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Example sliced_data_list</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>sliced_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">unique_pt_id =</span> <span class="dv">1</span>, <span class="at">seqnum =</span> <span class="dv">12602</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">day =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                                                       <span class="at">bcx_daily =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">unique_pt_id =</span> <span class="dv">2</span>, <span class="at">seqnum =</span> <span class="dv">18613</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">day =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                                                       <span class="at">bcx_daily =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># Call the function to search for sequence number 12602</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">search_by_seqnum</span>(sliced_data_list, <span class="dv">12602</span>)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt;   day bcx_daily</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; 1   1         0</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; 2   2         1</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; 3   3         0</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="shiny-app" class="section level2">
<h2>Shiny App</h2>
<p>An interactive R Shiny app was developed to enhance accessibility.
Users can upload their own data or explore a demo dataset to test the
package’s capabilities. Users can interact with the app through simple
actions (e.g., clicking buttons or entering inputs) to select subgroups,
adjust lab value thresholds, identify ASE cases, and download
outputs.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
